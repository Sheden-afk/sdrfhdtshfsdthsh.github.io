<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Романтический Мини-Квест</title>
  <!-- Пиксельный шрифт -->
  <link href="https://fonts.googleapis.com/css?family=Press+Start+2P" rel="stylesheet">
  <!-- Telegram Web App API -->
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <style>
    /* Общий фон и базовые стили */
    body {
      margin: 0;
      padding: 0;
      font-family: 'Press Start 2P', cursive;
      background: linear-gradient(135deg, #1e1e1e, #d6336c);
      color: #fff;
      text-align: center;
      overflow-x: hidden;
    }
    /* Общий контейнер для экранов */
    .screen {
      padding: 20px;
      min-height: 100vh;
      box-sizing: border-box;
    }
    /* Стили для главного контейнера */
    .container {
      max-width: 600px;
      margin: auto;
      background: rgba(0, 0, 0, 0.5);
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 0 20px rgba(0,0,0,0.7);
    }
    /* Стили для вкладок */
    .tabs {
      display: flex;
      justify-content: center;
      margin-bottom: 20px;
    }
    .tab {
      flex: 1;
      margin: 0 10px;
      padding: 15px;
      background: #333;
      border-radius: 5px;
      cursor: pointer;
      transition: background 0.3s;
    }
    .tab:hover {
      background: #444;
    }
    .tab.disabled {
      background: #555;
      cursor: default;
    }
    /* Стили для заголовков */
    h1, h2 {
      margin-bottom: 20px;
    }
    /* Стили для кнопок */
    button {
      margin-top: 20px;
      padding: 10px 20px;
      background: #4caf50;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-size: 14px;
      color: #fff;
      transition: background 0.3s;
    }
    button:hover {
      background: #45a049;
    }
    /* Стили для полей ввода */
    input[type="text"] {
      padding: 8px;
      font-size: 14px;
      border: 2px solid #444;
      border-radius: 5px;
      background: #292929;
      color: #fff;
      width: 80%;
      margin-top: 10px;
    }
    /* Стили финального экрана */
    #assembled-photo {
      max-width: 100%;
      border: 3px solid #fff;
      border-radius: 10px;
      margin-top: 20px;
    }
    /* Контейнер для анимации сердечек */
    #heart-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      overflow: hidden;
    }
    .heart {
      position: absolute;
      color: #ff4d4d;
      font-size: 24px;
      opacity: 0.8;
      animation: float 4s linear infinite;
    }
    @keyframes float {
      0% {
        transform: translateY(0) scale(1);
        opacity: 0.8;
      }
      100% {
        transform: translateY(-200px) scale(1.5);
        opacity: 0;
      }
    }
  </style>
</head>
<body>
  <!-- Экран Главной страницы -->
  <div id="screen-home" class="screen">
    <div class="container">
      <h1>Романтический Квест</h1>
      <div class="tabs">
        <div id="tab-7march" class="tab">7 марта</div>
        <div id="tab-14feb" class="tab">14 февраля</div>
      </div>
      <p>Выберите дату, чтобы начать незабываемое приключение!</p>
    </div>
  </div>

  <!-- Экран игры (квеста) -->
  <div id="screen-game" class="screen" style="display: none;">
    <div class="container">
      <h2>Романтический Квест</h2>
      <div id="puzzle-container">
        <!-- Здесь будут появляться головоломки -->
      </div>
    </div>
  </div>

  <!-- Финальный экран (собранная фотография и анимация сердечек) -->
  <div id="screen-final" class="screen" style="display: none;">
    <div class="container">
      <h2>Поздравляем!</h2>
      <p>Вы собрали всю фотографию!</p>
      <!-- Здесь можно вставить свою фотографию -->
      <img id="assembled-photo" src="https://via.placeholder.com/400x300.png?text=Assembled+Photo" alt="Собранная фотография">
    </div>
    <!-- Контейнер для анимации сердечек -->
    <div id="heart-container"></div>
  </div>

  <script>
    // Инициализируем Telegram Web App
    const tg = window.Telegram.WebApp;
    tg.expand();

    document.addEventListener("DOMContentLoaded", () => {
      const tab7March = document.getElementById("tab-7march");
      const tab14Feb = document.getElementById("tab-14feb");

      // Для демонстрации обе вкладки активны (используем прошедшие даты)
      // Если хотите реализовать блокировку по дате, добавьте проверки с new Date()

      // Обработчики нажатий
      tab7March.addEventListener("click", () => startGameFlow("7march"));
      tab14Feb.addEventListener("click", () => startGameFlow("14feb"));
    });

    // Функция переключения экранов
    function showScreen(screenId) {
      document.querySelectorAll('.screen').forEach(screen => {
        screen.style.display = "none";
      });
      document.getElementById(screenId).style.display = "block";
    }

    // Запуск квеста в зависимости от выбранной вкладки
    function startGameFlow(tab) {
      if (tab === "7march") {
        showScreen("screen-game");
        loadPuzzle(1);
      } else if (tab === "14feb") {
        // Для 14 февраля сразу показываем финальный экран с романтическим сюрпризом
        showScreen("screen-final");
        startHeartAnimation();
      }
    }

    // Загрузка головоломок по уровням
    function loadPuzzle(level) {
      const container = document.getElementById("puzzle-container");
      switch (level) {
        case 1:
          container.innerHTML = `
            <p>Головоломка 1:</p>
            <p>Введи слово, которое объединяет нас</p>
            <input type="text" id="answer1" placeholder="Ваш ответ">
            <br>
            <button onclick="checkPuzzle1()">Проверить</button>
          `;
          break;
        case 2:
          container.innerHTML = `
            <p>Головоломка 2:</p>
            <p>Найдите правильный путь – нажмите, если чувствуете верное решение</p>
            <button onclick="nextPuzzle(3)">Далее</button>
          `;
          break;
        case 3:
          container.innerHTML = `
            <p>Головоломка 3:</p>
            <p>Соберите пазл – нажмите, чтобы получить последнюю часть</p>
            <button onclick="finishGame()">Собрать пазл</button>
          `;
          break;
        default:
          container.innerHTML = `<p>Квест завершён</p>`;
      }
    }

    // Проверка ответа для головоломки 1
    function checkPuzzle1() {
      const answer = document.getElementById("answer1").value.toLowerCase().trim();
      // Правильный ответ: «любовь»
      if (answer === "любовь") {
        nextPuzzle(2);
      } else {
        alert("Неверно! Попробуйте ещё раз.");
      }
    }

    // Переход к следующей головоломке
    function nextPuzzle(level) {
      loadPuzzle(level);
    }

    // Завершение квеста — переход к финальному экрану
    function finishGame() {
      showScreen("screen-final");
      startHeartAnimation();
    }

    // Функция для анимации сердечек
    function startHeartAnimation() {
      const heartContainer = document.getElementById("heart-container");
      heartContainer.innerHTML = ""; // Очистка предыдущих сердечек
      // Функция создания одного сердечка
      const createHeart = () => {
        const heart = document.createElement("div");
        heart.className = "heart";
        heart.style.left = Math.random() * 100 + "vw"; // случайное положение по горизонтали
        heart.style.animationDuration = 3 + Math.random() * 3 + "s"; // случайная длительность анимации
        heart.textContent = "❤";
        heartContainer.appendChild(heart);
        // Удаляем сердце по окончании анимации (примерно через 6 секунд)
        setTimeout(() => heart.remove(), 6000);
      };
      // Каждые 500 мс создаём новое сердце
      setInterval(createHeart, 500);
    }
  </script>
</body>
</html>
